
<html>
<head>
<title>
page_ss_input
</title>
<link href="vv_workbook.css" type="text/css" rel="stylesheet">

<script language=javascript src="vv_functions.js"></script>
<script language=javascript src="vv_functions_radio.js"></script>
<script language=javascript src="vv_validation.js"></script>

<script>


// Only let numbers in the  Year field, max length=4
function testInput(event,sbox,Nlen) {
var e = event;
var KS; //keystroke value
var rmc = 2; //right mouse click IE
   // KS the keystroke entered
  if ( typeof(e.which) != 'undefined' ) {//netscape
	KS = e.which; 
  	rmc = 3; //right mouse click netscape
   }else { 
	KS = e.keyCode; 
   }
//alert("kStroke = " + KS +"\nsbox.value.length="+sbox.value.length);

var LEN = new Number(Nlen);
    LEN = LEN -1;
   if (sbox.value.length >LEN ) { 
	alert("You may not type more than "+Nlen+" digits for this input."); 
	return false; 
	} 


   if ((KS > 47) && (KS < 58)) { return true;} //integer
   if (KS == 8) return true; // Backspace
   if (KS == 9) return true; // Tab
   ////if (KS == 32) return true; //whitespace

   alert("Only integer numbers are allowed in this field.");

   return false;
}

function xxxbuildUTKfilename() {

var strFull = new String();


if ( document.forms[0].XMLmaster_01.value.length != 4 ) {
	alert("You must enter 4 digits for the Instition Number. ")
	document.forms[0].XMLmaster_01.value="";
	document.forms[0].XMLmaster_01.focus();
	return;
	}


if ( document.forms[0].XMLmaster_02.value.length != 6 ) {
	alert("You must enter 6 digits for the Collection Number. ")
	document.forms[0].XMLmaster_02.value="";
	document.forms[0].XMLmaster_02.focus();
	return;
	}

if ( document.forms[0].XMLmaster_03.value.length != 6 ) {
	alert("You must enter 6 digits for the Item Number. ")
	document.forms[0].XMLmaster_03.value="";
	document.forms[0].XMLmaster_03.focus();
	return;
	}
strFull =   document.forms[0].XMLmaster_01.value + "_"; 
strFull +=  document.forms[0].XMLmaster_02.value + "_";
strFull +=  document.forms[0].XMLmaster_03.value + "_";

document.forms[0].XMLBASE.value=strFull;
/*
if (!confirm ("Institution: "+document.forms[0].XMLmaster_01.value
	+"\nCollection: "+document.forms[0].XMLmaster_02.value
	+"\nItem: "+document.forms[0].XMLmaster_03.value
	+"\nBase File Name="+document.forms[0].XMLBASE.value
	+"\nFull Name: "+document.forms[0].adb_fullname.value
	+"\nusername: "+document.forms[0].adb_username.value
	+"\n\nGo to the Begin Page now?"
	)) return;
*/





//document.location.href = "page_begin.htm";

}//end function buildUTKfilename

function xxxenterValues() {
alert("enterValues");
if ( document.DF.XMLBASE.value == "" ) {
	alert("Please build UTK DLC filename.");
	return;
	}


}//end function enterValues





function enterServerSideValues() {

parent.U.document.UF.XMLBASE.value = document.DF.adb_itemfbname.value;
parent.adb_username = document.forms[0].adb_username.value;
parent.adb_fullname = document.forms[0].adb_fullname.value;
parent.adb_instname = document.forms[0].adb_instname.value;
parent.adb_instaddr = document.forms[0].adb_instaddr.value;
parent.adb_instcity = document.forms[0].adb_instcity.value;
parent.adb_instcounty = document.forms[0].adb_instcounty.value;
parent.adb_inststate = document.forms[0].adb_inststate.value;
parent.adb_instzip = document.forms[0].adb_instzip.value;
parent.adb_collidn = document.forms[0].adb_collidn.value;

var collidnd = new String();

for(i=0;i<6;i++ ) {
   parent.U.document.UF.collection_id_num_type[i].selected = document.DF.collection_id_num_type[i].selected;
   if (document.DF.collection_id_num_type[i].selected == true) {
	parent.adb_collidndes = document.DF.collection_id_num_type[i].value;
	}
}

///parent.adb_collidndes = document.forms[0].adb_collidndes.value;

parent.adb_collname = document.forms[0].adb_collname.value;
parent.adb_colldes = document.forms[0].adb_colldes.value;
parent.adb_collextent = document.forms[0].adb_collextent.value;
parent.adb_itemtempname = document.forms[0].adb_itemtempname.value;
parent.adb_itemtitle = document.forms[0].adb_itemtitle.value;
parent.adb_itemdate = document.forms[0].adb_itemdate.value;
parent.adb_itemdescr = document.forms[0].adb_itemdescr.value;
parent.adb_itemtype = document.forms[0].adb_itemtype.value;
parent.adb_genre = document.forms[0].adb_genre.value;
parent.adb_itemdim = document.forms[0].adb_itemdim.value;
parent.adb_itemlocation = document.forms[0].adb_itemlocation.value;
parent.adb_itemcreator = document.forms[0].adb_itemcreator.value;
parent.adb_projectname = document.forms[0].adb_projectname.value;
parent.adb_projectid = document.forms[0].adb_projectid.value;

alert("enterServerSideValues() done");

}//end function


function goToBeginPage() {
document.location.href = "page_begin.htm";
}





function load_DF_form() {
//dummy function
return;
}//end function

</script>

</head>


<script>document.write('<body bgcolor="'+parent.adb_background_color+'" onload="load_DF_form()" >');</script>
<font face="arial" size="3">
<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script>
 Workbook Server Side Input Page </h2>
</center>

<script>
///Civil War Salt Peter Mining None, LCNAF, ULAN. 


</script>

<form name="DF"  >

<table class="bgINNer"  border="0" cellpadding="2" cellspacing="1" width="98%" xbgcolor="ddeeff">
<tr class="bgstandard"><td colspan="3">&nbsp;
</td></tr>
<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>


<tr class="bgstandard">
<td colspan="3">The DLC-MODS Workbook is supported by a MySQL database designed and developed by
our own unsung hero Paul Cummins. 
<hr>
Because this database is  not available with this download, I am providing a Server Side Input page
to allow you to see how the server side input affects the different pages in the workbook. <br>When you submit
this form, it will create values in the parent frame, analogous to those values that would be posted from
the database to the DLC-MODS Workbook.  
<p>You can play with
the values, see what goes where, and ultimately adapt this code to work with your own database.



 &nbsp</td>
</tr>


<tr class="bgstandard">
<td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
</tr>

<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>

<tr class="bgstandard">
<td valign="top"><font face="arial" size="2" color="000000" ><b></u>
Server Side
&nbsp;
</td>
<td>For standard processing, these variables are supplied by a database on our server.
<br>Here they are entered as form variables to demonstrate how all the fields are filled in through each page of the workbook.
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
&nbsp;
</td>
<td>&nbsp;
<input type="button" value="Enter Server Side Values" name="B2" onclick="enterServerSideValues()" > 
&nbsp;&nbsp;&nbsp;<input type="button" value="Go to standard Begin Page" name="B1" onclick="goToBeginPage()" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
<form >
Base File Name
<br>parent.adb_itemfbname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="30" name="adb_itemfbname"  
value="0012_000060_000236_"
onKeypress="return testInput(event,this,6)"
xonKeypress="return digits_only_rule(event,this)" > Page Begin, Institution-Collection-Item
<br>&nbsp;The <u>Base File Name</u> created here will be used to name <u>Constituent Files</u> on Page 5.
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution ID
<br>parent.adb_institution_id 
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="30" name="XMLmaster_01"  
value="0012"
xonKeypress="return digits_only_rule(event,this)" > In UTK-DLC format, this is the first four digits of the Base File Name.
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Full Name
<br>parent.adb_fullname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="30" name="adb_fullname"  
value="default_fullname"
> Please enter your name. -- Begin Page, generated comments.
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
User Name
<br>parent.adb_username
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="30" name="adb_username"  
value="default_username"
> Please enter your username. -- Begin Page, generated comments.
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution
<br>parent.adb_instname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_instname"  
value="University of Tennessee Special Collections Library"
> -- Page 6, Contributing Institution
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution Address
<br>parent.adb_instaddr
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_instaddr"  
value = "James D. Hoskins Library, Room 200"
 > --  not displayed 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution City
<br>parent.adb_instcity
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_instcity"  
value = "Knoxville"
 > -- Page 6, City
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution County
<br>parent.adb_instcounty
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_instcounty"  
value = "Knox"
 > -- Page 6, County
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution State
<br>parent.adb_inststate
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_inststate"  
value = "Tennessee"
> -- Page 6, State
&nbsp;</td>
<td>&nbsp</td>
</tr>
<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Institution Zip
<br>parent.adb_instzip
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_instzip"  
value = "37996-4006"
> --  not displayed
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Collection ID #
<br>parent.adb_collidn
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_collidn"  
value = "253"
 > -- Page 6, Collection ID Number
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td valign="top"><font face="arial" size="2" color="000000" ><b></u>
Collection ID # Type
<br>parent.adb_collidndes
&nbsp;
</td>
<td>&nbsp;
<br><select size="6" name="collection_id_num_type">
<option value="none" >none selected</option>
<option value="manuscriptNumber" selected>Manuscript Number</option>
<option value="archiveNumber">Archive Number</option>
<option value="callNumber">Call Number</option>
<option value="accessionNumber">Accession Number</option>
<option value="otherIdentificationNumber">Other Identification Number</option>
</select> -- Page 6, Collection ID Number Type <br> A string value is passed from the AdminDB and this value
matches one of the option values in the dropdown list.<br>
So here the value passed is "manuscriptNumber", the option text is Manuscript Number.
<br>parent.adb_collidndes=<script>document.write(parent.adb_collidndes)</script>
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Collection Name 
<br>parent.adb_collname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_collname"  
value = "James Gettys McGready Ramsey Papers, 1790-1912"
 > -- Page 6, Collection Name
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td valign="top"><font face="arial" size="2" color="000000" ><b></u>
Collection Description
<br>parent.adb_colldes
&nbsp;
</td>
<td>&nbsp;
<textarea cols="60" rows="8" name="adb_colldes"  
>This collection consists primarily of correspondence and some official documents related to both the Ramsey family and J.G.M. Ramsey\'s historical research, including his research on the Mecklenburg Declaration. Ramsey was a physician, public servant, secessionist, religious leader, banker, railroad advocate, and scholar of early Tennessee history.</textarea>
--  not displayed
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Collection Extent
<br>parent.adb_collextent
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_collextent"  
value = "3 boxes"
 > -- Page 3, Extent Help display
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Temp Name
<br>parent.adb_itemtempname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemtempname"  
value = "temp"
 > -- project identifier, not displayed
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td valign="top"><font face="arial" size="2" color="000000" ><b></u>
Item Title
<br>parent.adb_itemtitle
&nbsp;
</td>
<td>&nbsp;
<textarea cols="60" rows="5" name="adb_itemtitle"  
>Letter, Gen. Andrew Jackson, the Hermitage, Nashville, Tenn., to J.G.M. Ramsey, Mecklenburg, near Knoxville, Tenn. 1823 June 14</textarea>
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Date
<br>parent.adb_itemdate
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemdate"  
value = "1823-06-14"
 > 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td valign="top"><font face="arial" size="2" color="000000" ><b></u>
Genre Description (abstract)
<br>parent.adb_itemdescr
&nbsp;
</td>
<td>&nbsp;
<textarea cols="60" rows="5" name="adb_itemdescr"  
>1823 June 14 Gen. Andrew Jackson, the Hermitage, near Nashville, Tenn., to J.G.M. Ramsey, Mecklenburg, 
near Knoxville, Tenn. In reply to Dr. Ramsey's request, explains that he was too young to take part in the Mecklenburg 
Convention and that he can offer no further information on the subject.</textarea>
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Type (of resource)
<br>parent.adb_itemtype
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemtype"  
value = "text"
 > 
&nbsp;</td>
<td>&nbsp</td>
</tr>


<tr class="bgstandard">
<td valig="top"><font face="arial" size="2" color="000000" ><b></u>
Item Genre
<br>parent.adb_genre
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60"  name="adb_genre"  
value="letter">
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Dimensions
<br>parent.adb_itemdim
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemdim"  
value = "optional" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Location
<br>parent.adb_itemlocation
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemlocation"  
value = "details on location" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Item Creator (the author)
<br>parent.adb_itemcreator
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_itemcreator"  
value = "Gen. Andrew Jackson" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Project Name
<br>parent.adb_projectname
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_projectname"  
value = "DLC-MODS" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
Project ID 
<br>parent.adb_projectid
&nbsp;
</td>
<td>&nbsp;
<input type="text" size="60" name="adb_projectid"  
value = "DLC" > 
&nbsp;</td>
<td>&nbsp</td>
</tr>



<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>






<tr class="bgstandard"><td colspan="3" align="center">
&nbsp;&nbsp;

</td></tr>

</table>


</form name="forms[0]">



<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script>
 Workbook Server Side Input Page </h2>
</center>
<hr>
<script>


/////chdchdchd





</script>
	


</body>
</html>

