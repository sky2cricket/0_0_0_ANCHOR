<!--
    This code is issued under the GNU General Public License, 
    version 3, 29 June 2007.

    The DLC-MODS Workbook provides a series of web pages to help you 
    generate a MODS metadata record that follows the Digital Library 
    Federation Implementation Guidelines for Shareable MODS Records, 
    as described in the DLF Aquifer Guidlines November 2006.  These 
    Guidelines and the specific MODS Profile are documented on the 
    MODS Profile Page of the DLC-MODS Workbook.

    Copyright (C) 2007 
    Christine Haygood Deane 
    University of Tennessee Libraries
    Digital Library Center
 

    This program is free software: you can redistribute it and/or modify    
    it under the terms of the GNU General Public License as published by    
    the Free Software Foundation, version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see http://www.gnu.org/licenses/
-->

<html>
<head>
<title>
page_01
</title>
<link href="vv_workbook.css" type="text/css" rel="stylesheet">

<!---
<script language=javascript src="vv_functions.js"></script>
<script language=javascript src="vv_functions_radio.js"></script>
<script language=javascript src="vv_validation.js"></script>
--->
<script language=javascript src="vv_compose_tags.js"></script>

<script>

var split_token=parent.U.split_token;

function test_DF_form(){
alert("under construction");
}

function addOneNameBlock() {
if (!confirm("You have chosen to add one Name Block.\n\nDo you wish to continue?")){return;}
var N = new Number( parent.U.document.UF.numNameBlocks.value);
N=N+1;
parent.U.document.UF.numNameBlocks.value = N;
buildModsTags(11);
parent.U.document.UF.VVcomment_02c.value = "<!-- NUMBER_OF_NAME_BLOCKS: "+N+": -->";
//alert("parent.U.document.UF.name_block_list.value=\n"+parent.U.document.UF.name_block_list.value
 // +"\nparent.D.document.DF.name_block_list.value=\n"+parent.D.document.DF.name_block_list.value)
parent.D.location.replace("page_01.htm");
}//end function


function subtractOneNameBlock() {
var N = new Number( parent.U.document.UF.numNameBlocks.value);
if (N==1) {
        alert("Name Block #1 may not be removed.");
        return;
        }
if (!confirm("You have chosen to remove one Name Block.\n\nDo you wish to continue?")){return;}
N=N-1;
parent.U.document.UF.numNameBlocks.value = N;
buildModsTags(11);
parent.U.document.UF.VVcomment_02c.value = "<!-- NUMBER_OF_NAME_BLOCKS: "+N+": -->";
//alert("parent.U.document.UF.name_block_list.value=\n"+parent.U.document.UF.name_block_list.value
 // +"\nparent.D.document.DF.name_block_list.value=\n"+parent.D.document.DF.name_block_list.value)
parent.D.location.replace("page_01.htm");
}//end function





</script>




</head>

<script>document.write('<body onload="load_DF_form();"  bgcolor="'+parent.adb_background_color+'" >');</script>

<font face="arial" size="3">
<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script>
 Page 1 DEV</h2>
</center>

<form name="DF"  >

<table  class="bgINNER"  border="0" cellpadding="2" cellspacing="1" width="98%" xbgcolor="99aabb">
<tr class="bgstandard" ><td colspan="3">

&nbsp;
</td></tr>
<tr class="greenrow">
<td><font face="arial" size="3" color="ffffff" ><b>MODS LABEL</td>
<td><font face="arial" size="3" color="ffffff" ><b>VALUE</td>
<td><font face="arial" size="3" color="ffffff" >&nbsp;</td>
</tr>

<tr class="bgstandard" ><td colspan="3">
<b>Title Information</b>
</td></tr>

<tr class="bgstandard" >
<td class="label13nou">
Non Sort 
</td>
<td>&nbsp;
<input type="text" name="title_non_sort" value="" size="36" 
class="notrequired300w"
onmousedown="return parent.L.stopCutAndPaste(this,event)"
onkeypress="return parent.L.stopCutAndPaste(this,event)"
onkeydown="return parent.L.stopCutAndPaste(this,event)"
>
<font face='arial' size='1'>
</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard" >
<td class="label13u">
Title 
</td>
<td>&nbsp;
<input type="text" name="title" value="" size="36" 
class="required300w"
onmousedown="return parent.L.stopCutAndPaste(this,event)"
onkeypress="return parent.L.stopCutAndPaste(this,event)"
onkeydown="return parent.L.stopCutAndPaste(this,event)"
>
<font face='arial' size='1'>
</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard" >
<td class="label13nou">
Sub Title 
</td>
<td>&nbsp;
<input type="text" name="title_sub_title" value="" size="36" 
class="notrequired300w"
onmousedown="return parent.L.stopCutAndPaste(this,event)"
onkeypress="return parent.L.stopCutAndPaste(this,event)"
onkeydown="return parent.L.stopCutAndPaste(this,event)"
>
<font face='arial' size='1'>
</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard" >
<td class="label13nou">
Part Number
</td>
<td>&nbsp;
<input type="text" name="title_part_number" value="" size="36" 
class="notrequired300w"
onmousedown="return parent.L.stopCutAndPaste(this,event)"
onkeypress="return parent.L.stopCutAndPaste(this,event)"
onkeydown="return parent.L.stopCutAndPaste(this,event)"
>
<font face='arial' size='1'>
</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard" >
<td class="label13nou">
Part Name
</td>
<td>&nbsp;
<input type="text" name="title_part_name" value="" size="36" 
class="notrequired300w"
onmousedown="return parent.L.stopCutAndPaste(this,event)"
onkeypress="return parent.L.stopCutAndPaste(this,event)"
onkeydown="return parent.L.stopCutAndPaste(this,event)"
>
<font face='arial' size='1'>
</td>
<td>&nbsp</td>
</tr>
</table>

<table  class="bgINNER"  border="0" cellpadding="2" cellspacing="1" width="98%" xbgcolor="99aabb">
<!--

///////////////////////////NAME BLOCK//////////////////////

-->
<script>
var name_block_count=0;
var a400 =  new String('400');
var a500 =  new String('500');
var a550 =  new String('550');
var a600 =  new String('600');
</script>

<tr class="greenrow">
<td height="08" colspan="3"></td></tr>
<tr class="bgstandard"  >
<td colspan="3"><font face="arial" size="3">Three name and name attributes blocks allow for creation of
up to 3 sets of mods:name tags.
<br>The following Name Authorities are available:
<li> LCNAF -- Complete Description at: <a href="http://authorities.loc.gov/" target="_blank">http://authorities.loc.gov/</a>
<li> ULAN -- Complete Description at: <a href="http://www.getty.edu/research/conducting_research/vocabularies/ulan/" target="_blank">http://www.getty.edu/research/conducting_research/vocabularies/ulan/</a>
</td><!---td>&nbsp;</td--->
</tr>

<script>
var a400 =  new String('400');
var a500 =  new String('500');
var a550 =  new String('550');
var a600 =  new String('600');


/////---------start dynamic--------------------------------
var numN = new Number(parent.U.document.UF.numNameBlocks.value);
for (i=0;i<numN;i++){
name_block_count=i+1;//display only
document.write(
 '<tr class="greenrow">\r\n'
+'<td colspan="3"><font face="arial" size="3" color="ffffff" ><b> Name # '+name_block_count+'</td></tr>\r\n'
+'<tr class="bgstandard"   >\r\n'
+'<td colspan="2">\r\n'
+'<table border="1" cellpadding="2" cellspacing="0" width="500px">\r\n'
+'<tr>\r\n'
+'<td class="label13nou">Recommended fields</td>\r\n'
+'<td><font face="arial" size="1">&nbsp;&nbsp;name type<br>&nbsp;\r\n'
+'<select size="1" name="dyn_name_type_0'+i+'" style="background:#ffffff">\r\n'
+'<option value="personal" selected>personal</option>\r\n'
+'<option value="corporate">corporate</option>\r\n'
+'<option value="conference">conference</option>\r\n'
+'</select></font></td>\r\n'
+'<td><font face="arial" size="1">&nbsp;&nbsp;name authority<br>&nbsp;\r\n'
+'<select size="1" name="dyn_name_authority_0'+i+'" style="background:#ffffff"; >\r\n'
+'<option value="none" selected>none - for pers, corp, and conf</none>\r\n'
+'<option value="LCNAF">LCNAF - for pers and corp</option>\r\n'
+'<option value="ULAN">ULAN - for personal only</option>\r\n'
+'</select></font></td>\r\n'
+'<td><font face="arial" size="1">&nbsp;&nbsp;personal lastname OR corporate/conference name<br> &nbsp;\r\n'
+'<input type="text" name="dyn_name_lastname_0'+i+'" value="" size="42" class="requirednw"></font></td></tr>\r\n'
+'<tr class="bgstandard"   >\r\n'
+'<td class="label13nou" rowspan="2">Optional fields</td>\r\n'
+'<td valign="top" colspan="2"><font face="arial" size="1">&nbsp;&nbsp;given name (personal only, first and middle names or initials)<br>&nbsp;\r\n'
+'<input type="text" name="dyn_name_givenname_0'+i+'" value="" size="44" class="notrequirednw"></font></td>\r\n'
//+'<input type="text" name="dyn_name_firstname_0'+i+'" value="" size="44" class="notrequirednw"></font></td>\r\n'
//+'<td valign="top"><font face="arial" size="1">&nbsp;&nbsp;middle name (personal only)<br>&nbsp;\r\n'
//+'<input type="text" name="dyn_name_middlename_0'+i+'" value="" size="28" class="notrequirednw"></font></td>\r\n'
+'<td valign="top"><font face="arial" size="1">&nbsp;&nbsp;termsOfAddress (personal only)<br> &nbsp;\r\n'
+'<input type="text" name="dyn_name_toa_0'+i+'" value="" size="28" class="notrequirednw"></td>\r\n'
+'</tr>\r\n'

+'<tr>\r\n'
+'<td colspan="2"><font face="arial" size="1">&nbsp;&nbsp;role<br> &nbsp;\r\n'
+'<input type="text" name="dyn_name_role_0'+i+'" value="" size="2" READONLY class="notrequired300w">\r\n'
+'<input type="button" name="Bdyn_name_role_0'+i+'" value="Select" class="button80w" onclick="parent.L.selectOneOptionSubject(this,a400,a600)">\r\n'
+'<input type="button" name="Cdyn_name_role_0'+i+'" value="Clear" class="button80w" onclick="parent.L.clearSelection(this,2)">\r\n'
+'<font face="arial" size="1" color="000000" ><br>&nbsp;&nbsp;&nbsp;Complete Role Descriptions from \r\n'
+'<a href="http://www.loc.gov/marc/sourcecode/relator/relatorlist.html" target="blank">MARK Relatorlist</a>.  Select up to 3 Role terms.</font></td>\r\n'
+'<td valign="top"><font face="arial" size="1">&nbsp;&nbsp;&nbsp;&nbsp;vital dates (personal only)\r\n'
+'<br>&nbsp;&nbsp;\r\n'
+'<input type="button" name="Bdyn_name_ydob_0'+i+'" value="Year of Birth" class="button80w" '
+'onclick="parent.L.selectOneOptionSubject(this,a500,a550)">&nbsp;\r\n'
+'<input type="text" name = "dyn_name_ydob_0'+i+'" value="" size="10"  value="" class="notrequirednw" READONLY>\r\n'
+'<input type="button" name="Cdyn_name_ydob_0'+i+'" value="Clear Year" class="button80w" onclick="parent.L.clearDateNoQual(this)">&nbsp;&nbsp;&nbsp;\r\n'
+'<br>&nbsp;&nbsp;\r\n'
+'<input type="button" name="Bdyn_name_ydod_0'+i+'" value="Year of Death" class="button80w" '
+'onclick="parent.L.selectOneOptionSubject(this,a500,a550)">&nbsp;\r\n'
+'<input type="text" name = "dyn_name_ydod_0'+i+'" value="" size="10"  value="" class="notrequirednw" READONLY>\r\n'
+'<input type="button" name="Cdyn_name_ydod_0'+i+'" value="Clear Year" class="button80w" onclick="parent.L.clearDateNoQual(this)">\r\n'
+'&nbsp;&nbsp;&nbsp;</td></tr></table></td>\r\n'
+'<td>&nbsp;</td>\r\n'
+'</tr>\r\n'
+'<tr class="bgstandard" >\r\n'
+'<td colspan="3"><font face="arial" size="1">&nbsp;&nbsp;If no value for personal lastname OR corporate/conference name '
+' (highlighted in yellow above) is filled in, no tags will be made for Name # '+name_block_count+' block.</font></td>\r\n'
+'</tr>\r\n'
);
}//end for
</script>

<!---------end dynamic-------------------------------->

</table>


<table  class="bgINNER"  border="0" cellpadding="2" cellspacing="1" width="98%" xbgcolor="99aabb">
<!--tr class="greenrow"> <td height="08" colspan="3"></td></tr-->
<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>
<tr class="bgstandard">
<td class="label13u">Add or Remove<br>One Name Block</td><td>&nbsp;
<input type="button" name="AddOne"
value="Click here to Add One Name Block" class="buttonnw" onClick="addOneNameBlock();">
<input type="button" name="SubtractOne"
value="Click here to Remove One Name Block" class="buttonnw" onClick="subtractOneNameBlock();">

</td><td>&nbsp;</td>
</tr>



<tr class="bgstandard" >
<td >&nbsp</td><td>&nbsp</td><td>&nbsp</td>
</tr>
<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>
<tr class="bgstandard" ><td colspan="3" align="center">
&nbsp;&nbsp;
<input type="button" name="B_UF" value="Save" class="buttonnw" onclick="buildModsTags(10);">
<input type="button" name="B_DF" value="load_DF_form"  class="buttonnw" onclick="load_DF_form();">
<input type="button" name="B2" 
value="Save Data and View MODS TAGS" class="buttonnw"
onclick="buildModsTags(1)">

</td></tr>
<tr class="bgstandard" >
<td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
</tr>

</table>


<input type="hidden" name="name_block_list" value="">





</form name="forms[0]">


<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script> </h2>
</center>

<script>


function load_UF_form() {

////parent.U.document.UF.validate_page_01.value="0"; //no caching from previous value

//alert("load_UF_form()");
///PageOneTitleInfo

parent.U.document.UF.title_non_sort.value = document.DF.title_non_sort.value;
parent.U.document.UF.title.value = document.DF.title.value;
parent.U.document.UF.title_sub_title.value = document.DF.title_sub_title.value;
parent.U.document.UF.title_part_number.value = document.DF.title_part_number.value;
parent.U.document.UF.title_part_name.value = document.DF.title_part_name.value;

parent.U.document.UF.name_block_list.value = document.DF.name_block_list.value;

return;


}


function load_DF_form() {

////////alert("load_DF_form()");


//first time load title
if ( parent.U.document.UF.title.value == "" ) {
	document.DF.title.value = parent.adb_itemtitle;
}else{
	document.DF.title.value = parent.U.document.UF.title.value ;
}


document.DF.title_non_sort.value = parent.U.document.UF.title_non_sort.value ;
document.DF.title.value = parent.U.document.UF.title.value ;
document.DF.title_sub_title.value = parent.U.document.UF.title_sub_title.value ;
document.DF.title_part_number.value = parent.U.document.UF.title_part_number.value ;
document.DF.title_part_name.value = parent.U.document.UF.title_part_name.value ;

//====================================================================================

////alert("begin function load_DF_form");
var split_token=parent.U.split_token;
////alert("load_DF_FORM split_token="+split_token);
////alert("load_DF_form(): parent.U.document.UF.name_block_list.value=\n"+parent.U.document.UF.name_block_list.value);
if (parent.U.document.UF.name_block_list.value == "" ) {
        return;
        }

document.DF.name_block_list.value = parent.U.document.UF.name_block_list.value;

/////alert("load_DF_form(): document.DF.name_block_list.value=\n"+document.DF.name_block_list.value);

var nbL = new String(parent.U.document.UF.name_block_list.value);
var Anb = new Array();
var m=0; //counter for Anb[m] array
    Anb = nbL.split(split_token);
for(i=0;i<document.DF.length;i++)
{
if ( typeof(Anb[m]) != "undefined" ) {
sbox = document.DF.elements[i];
if ( sbox.name.indexOf("dyn_name") == 0 ) {
	alert("document.DF.elements["+i+"].name="+sbox.name +"\n\nAnb["+m+"]="+Anb[m]);
	if ( Anb[m] != "empty_string") {
		sbox.value = Anb[m++];
	   }else {
		sbox.value = "";
		m++;
	   }
	//alert("document.DF."+sbox.name+".value="+sbox.value);
        }//end if (sbox.name.indexOf("dyn_name")...
}
}//end for

return;
}//end function load_DF_form


function buildModsTags(N) {

var split_token=parent.U.split_token;

var nbaAll = new String("");
var s= new String("");
var numNameBlocks = new Number(parent.U.document.UF.numNameBlocks.value);
var numNameBlockElements =0;
    numNameBlockElements = 9*numNameBlocks;//there are 9 elements per name block
var j=0;
for(i=0;i<document.DF.length;i++)
{
s = document.DF.elements[i];
if ( s.name.indexOf("dyn_name") == 0 ) {
	j++;
	if (s.value.length == 0) {	
		nbaAll += split_token + "empty_string";
	}else{
		nbaAll += split_token + s.value;
	}
}
if ( j>numNameBlockElements ) break;
}//end for
	
///alert("numNameBlocks="+numNameBlocks);

nbaAll = nbaAll.substring(split_token.length);

//alert("nbaAll ="+nbaAll)
document.DF.name_block_list.value = nbaAll;
parent.U.document.UF.name_block_list.value = nbaAll;


////do this first so current values are loaded regardless of validation status
load_UF_form();
if (num == 11) {return;} //before validation check

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
//before writing MODS TAGS, make sure all required fields are populated
//checkAllRequired... true  validation sets validation status to 1  -- complete
//checkAllRequired... false validation sets validation status to 0  -- incomplete

/* rewrite
if (!parent.L.checkAllRequiredElements_Page_01() ) {
	parent.L.update_page_validation(1,0);
	return;
}*/
parent.L.update_page_validation(1,1);

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

var num = new Number();
    num = N;

if (num == 11) {return;}
if (num == 10) {
        alert("Values have been saved.");
        return;
        }

//alert("got to here")

var aps= new Array();
var hps= new Array();
var cps= new Array();

    hps = buildTagsArray_header(num);
    aps = buildTagsArray_page_01(num);
    cps = buildTagsArray_closer(num);


   

//=================================================

document.write('<input type="button" name="BBACK" onclick="javascript: history.back()" value="BACK"><P>');
document.write('<font face="Elephant" size="3" color="a00000">'+parent.adb_project_name+' Workbook, Page 1<p></font>');
//PRELIMINARY COPY FOR DEMONSTRATION PURPOSES ONLY</font><p>'
//document.write( "This is the generated xml script.  Values you entered are highlighted in red.<HR>");
document.write('<font face="Elephant" size="3" color="a00000">PRELIMINARY COPY FOR DEMONSTRATION PURPOSES ONLY</font><p>'
		+"This is the generated xml script.  Values you entered are highlighted in red."
		+"<HR>");

//document.write('< ? xml version="1.0"  ? > \r\n'); 
///document.write("Content-Type: text/xml ")

for (i=0;i<hps.length;i++) {
	var vps = new String(hps[i]);
 	document.write("<br>"+vps);

	}



for (i=0;i<aps.length;i++) {
	var vps = new String(aps[i]);
	document.write("<br>"+vps);

	}



for (i=0;i<cps.length;i++) {
	var vps = new String(cps[i]);
	document.write("<br>"+vps);

	}


}//end function

</script>
	

<hr>

</body>
</html>

