<!--
    This code is issued under the GNU General Public License, 
    version 3, 29 June 2007.

    The DLC-MODS Workbook provides a series of web pages to help you 
    generate a MODS metadata record that follows the Digital Library 
    Federation Implementation Guidelines for Shareable MODS Records, 
    as described in the DLF Aquifer Guidlines November 2006.  These 
    Guidelines and the specific MODS Profile are documented on the 
    MODS Profile Page of the DLC-MODS Workbook.

    Copyright (C) 2007 
    Christine Haygood Deane 
    University of Tennessee Libraries
    Digital Library Center
 

    This program is free software: you can redistribute it and/or modify    
    it under the terms of the GNU General Public License as published by    
    the Free Software Foundation, version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see http://www.gnu.org/licenses/
-->

<html>
<head>
<title>
page_04
</title>
<link href="vv_workbook.css" type="text/css" rel="stylesheet">

<script language=javascript src="vv_compose_tags.js"></script>

<script>
function clearText_01(N){
var n = new Number(N);

if (n==0) {
	document.forms[0].subject_01_auth.value="";
	document.forms[0].subject_01.value="";
	document.forms[0].subject_01_auth_close.value="";
}

if (n==1) {
	document.forms[0].subject_01_auth.value="";
	document.forms[0].subject_01_auth_close.value="";
}

if (n==2) {
	document.forms[0].subject_01.value="";
}

}//end function clearText
</script>

</head>


<script> document.write('<body onload="load_DF_form();"  bgcolor="'+parent.adb_background_color+'" >'); </script>
<font face="arial" size="3">
<center>
<h2><script> document.write(parent.adb_project_name); </script>
 Page 4</h2></center>
<form name="DF">
<table class="bgINNER"  border="0" cellpadding="2" cellspacing="1" width="98%" >
<tr class="bgstandard"><td colspan="3">
<p>
For the rules on building a MODS Subject Block, please refer to 
<a href="http://www.diglib.org/aquifer/dlfmodsimplementationguidelines_finalnov2006.pdf" target="_blank">DLF Aquifer Guidlines</a>.
</p>
</td></tr>

<script>
var a500 = new String("500");
var a600 = new String("600");
var a700 = new String("700");

var numSubBlocks = new Number(parent.U.document.UF.numSubjectBlocks.value);
var j=0;

for (k=0;k<numSubBlocks;k++) {
j=k+1;//use for LABEL ONLY
document.write(
 '<tr class="greenrow"><td colspan="3" ><font face="arial" size="3" color="ffffff">\r\n'
+'<b>Subject Block #'+j+'</td></tr>\r\n'
+'<tr class="bgstandard" >\r\n'
+'<td class="label13u">\r\n'
+'Subject Block #'+j+'\r\n'
+'</td>\r\n'
+'<td>\r\n'
+'<input type="text" name="subject_0'+k+'_auth" size="40" value="<mods:subject authority='+k+'>"\r\n'
+'style="font-face:arial; font-weight:bold; font-size:12px; color:#000080; xwidth:300px" READONLY><br>\r\n'
+'<textarea name="subject_0'+k+'" cols="80" rows="12" READONLY\r\n'
+'style="font-face:arial; font-weight:bold; font-size:12px; color:#000080; xwidth:300px">SUBJECT_0'+k+' TAGS</textarea>\r\n'
+'<br><input type="text" name="subject_0'+k+'_auth_close" size="40" value="</mods:subject>"\r\n'
+'style="font-face:arial; font-weight:bold; font-size:12px; color:#000080; xwidth:300px" READONLY>\r\n'
+'<br>&nbsp;\r\n'
+'<input type="button" name="Bauth_subject_0'+k+'" value="select subject authority" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a700,a700)">\r\n'
+'<input type="button" name="Clear_subject_0'+k+'" value="clear all" class="button140w"\r\n'
+'onclick="clearText_01(0)">\r\n'
+'<input type="button" name="Clear_subject_0'+k+'a" value="clear subject authority" class="button140w"\r\n'
+'onclick="clearText_01(1)">\r\n'
+'<input type="button" name="Clear_subject_0'+k+'b" value="clear subelements" class="button140w"\r\n'
+'onclick="clearText_01(2)">\r\n'
+'<br>&nbsp;\r\n'
+'<input type="button" name="Bcart_subject_0'+k+'" value="cartographics" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Bcgeo_subject_0'+k+'" value="geographicCode" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Bhgeo_subject_0'+k+'" value="hierarchicalGeographic" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Bgeog_subject_0'+k+'" value="geographic" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<br>&nbsp;\r\n'
+'<input type="button" name="Bgenr_subject_0'+k+'" value="genre" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Btopi_subject_0'+k+'" value="topic" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Boccu_subject_0'+k+'" value="occupation" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Btemp_subject_0'+k+'" value="temporal" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a600,a600)">\r\n'
+'<br>&nbsp;\r\n'
+'<input type="button" name="Bnamp_subject_0'+k+'" value="name personal" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Bnamc_subject_0'+k+'" value="name corporate" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Bnamm_subject_0'+k+'" value="name conference" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<input type="button" name="Btitl_subject_0'+k+'" value="titleInfo" class="button140w"\r\n'
+'onclick="parent.L.selectOneOptionSubject(this,a500,a600)">\r\n'
+'<br>&nbsp;\r\n'
+'<font face="arial" size="1" color="000000" ><br> A Subject Block must contain at least\r\n'
+'one Subelement Block.\r\n'
+'<br>Click on the Subelement Name to create the corresponding Subelement Block.\r\n'
+'</td>\r\n'
+'<td>&nbsp</td>\r\n'
+'</tr>\r\n'
);
}///end for j


</script>

<input type="hidden" name="subject_auth_list" value="">
<input type="hidden" name="subject_list" value="">
<input type="hidden" name="subject_auth_close_list" value="">


<input type="hidden" name="subject_block_list" value="">



<tr class="bgstandard">
<td>&nbsp</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>


<tr class="bgstandard"><td colspan="3" align="center">
&nbsp;&nbsp;
<input type="button" name="B_UF" value="Save" class="buttonnw" onclick="buildModsTags(10);">
<!---input type="button" name="B_DF" value="Reset"  class="buttonnw" onclick="load_DF_form();"--->

<input type="button" name="B2" 
value="Save Data and View MODS TAGS" class="buttonnw"
onclick="buildModsTags(1)">


</td></tr>
<tr class="bgstandard" >
<td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
</tr>

</table>

</form name="forms[0]">


<center><font face="arial">
<h2><script> document.write(parent.adb_project_name); </script></h2>
</center>

<script>


function load_UF_form() {


var numS = parent.U.document.UF.numSubjectBlocks.value;

parent.U.document.UF.subject_list.value = document.DF.subject_list.value;
parent.U.document.UF.subject_auth_list.value = document.DF.subject_auth_list.value;
parent.U.document.UF.subject_auth_close_list.value = document.DF.subject_auth_close_list.value;

parent.U.document.UF.subject_block_list.value = document.DF.subject_block_list.value;

return;
}

function load_DF_form() {

if (parent.U.document.UF.subject_list.value == "" ) {
	return;
	}

document.DF.subject_list.value = parent.U.document.UF.subject_list.value;
document.DF.subject_auth_list.value = parent.U.document.UF.subject_auth_list.value;
document.DF.subject_auth_close_list.value = parent.U.document.UF.subject_auth_close_list.value;
document.DF.subject_block_list.value = parent.U.document.UF.subject_block_list.value;

var subaL = new String(parent.U.document.UF.subject_list.value);
var subbL = new String(parent.U.document.UF.subject_auth_list.value);
var subcL = new String(parent.U.document.UF.subject_auth_close_list.value);
var subdL = new String(parent.U.document.UF.subject_block_list.value);


var Asa = new Array(); 
var Asb = new Array();
var Asc = new Array();
var Asd = new Array();

Asa = subaL.split(",");
Asb = subbL.split(",");
Asc = subcL.split(",");
Asd = subdL.split(",");

var numS = parent.U.document.UF.numSubjectBlocks.value;
var sa = new String("");
var sb = new String("");
var sc = new String("");
var sd = new String("");

for (k=0;k<numS;k++){
alert(" 1. load_DF_form\n  k="+k+"\nsd="+sd);
sa='document.DF.subject_0'+k+'.value = Asa[k]';
sb='document.DF.subject_0'+k+'_auth.value = Asb[k]'; 
sc='document.DF.subject_0'+k+'_auth_close.value = Asc[k]';
sd+= ","+sa+","+sb+","+sc;
alert(" 2. load_DF_form\n  k="+k+"\nsd="+sd);


eval(sa);
eval(sb);
eval(sc);
eval(sd);

}//end for


/*
document.DF.subject_01.value = parent.U.document.UF.subject_01.value;
document.DF.subject_01_auth.value = parent.U.document.UF.subject_01_auth.value;//chdchdchd
document.DF.subject_01_auth_close.value = parent.U.document.UF.subject_01_auth_close.value;
*/

return;
}///end function load_DF_form



function buildModsTags(N) {

var numS = parent.U.document.UF.numSubjectBlocks.value;
var sa = new String("");
var sb = new String("");
var sc = new String("");
var sd = new String("");
var saList = new String("");
var sbList = new String("");
var scList = new String("");
var sdList = new String("");

for (k=0;k<numS;k++){
sa='saList+=","+document.DF.subject_0'+k+'.value';
sb='sbList+=","+document.DF.subject_0'+k+'_auth.value'; 
sc='scList+=","+document.DF.subject_0'+k+'_auth_close.value';


/*
sd ='sdList+=","+document.DF.subject_0'+k+'.value';
sd+='sdList+=","+document.DF.subject_0'+k+'_auth.value'; 
sd+='scList+=","+document.DF.subject_0'+k+'_auth_close.value';
*/


sd='sdList+=","+document.DF.subject_0'+k+'_auth.value;'
  +'","+document.DF.subject_0'+k+'.value;' 
  +'","+document.DF.subject_0'+k+'_auth_close.value;';


alert("sd=\n"+sd)
eval(sa);
eval(sb);
eval(sc);
eval(sd);
//alert("saList="+saList);
alert("sdList="+sdList);

}

saList = saList.substring(1);
sbList = sbList.substring(1);
scList = scList.substring(1);
sdList = sdList.substring(1);

document.DF.subject_list.value=saList;
document.DF.subject_auth_list.value = sbList;
document.DF.subject_auth_close_list.value = scList;
//document.DF.subject_block_list.value = sdList;

alert("saList="+saList
     +"\nsbList="+sbList
     +"\nscList="+scList
	);
alert("sdList=\n"+sdList);



var split_token=new String("");
    split_token="\n";
var sbaAll = new String("");
var s= new String("");
for(i=0;i<document.DF.length;i++)
{
s = document.DF.elements[i].name;
if ( s.indexOf("subject_0") == 0 ) {
	sbaAll += split_token + document.DF.elements[i].value;
	alert("document.DF.elements["+i+"].name="+s);
	}
}

/*
sbaAll = split_token +document.DF.elements[0].value
       + split_token +document.DF.elements[1].value
       + split_token +document.DF.elements[2].value
       + split_token +document.DF.elements[19].value
       + split_token +document.DF.elements[20].value
       + split_token +document.DF.elements[21].value
       ;
*/
sbaAll = sbaAll.substring(split_token.length);

alert("sbaALL ="+sbaAll)
document.DF.subject_block_list.value = sbaAll;

	
////do this first so current values are loaded regardless of validation status
load_UF_form();

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
//before writing MODS TAGS, make sure all required fields are populated
//checkAllRequired... true  validation sets validation status to 1  -- complete
//checkAllRequired... false validation sets validation status to 0  -- incomplete

/*
if (!parent.L.checkAllRequiredElements_Page_04() ) {
	//parent.L.update_page_validation(4,0); //need to rewrite this function
	return;
}*/
parent.L.update_page_validation(4,1);

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

var num = new Number();
    num = N;

if (num == 10) {
        alert("Values have been saved.");
        return;
        }


var aps= new Array();
var hps= new Array();
var cps= new Array();
    
    hps = buildTagsArray_header(num);
    aps = buildTagsArray_page_04(num);
    //aps = buildTagsArray_page_04_new(num);
    cps = buildTagsArray_closer(num);

//=================================================

document.write('<input type="button" name="BBACK" onclick="javascript: history.back()" value="BACK"><P>');
document.write('<font face="Elephant" size="3" color="a00000">'+parent.adb_project_name+' Workbook, Page 4<p></font>');
//PRELIMINARY COPY FOR DEMONSTRATION PURPOSES ONLY</font><p>'
document.write('<font face="Elephant" size="3" color="a00000">PRELIMINARY COPY FOR DEMONSTRATION PURPOSES ONLY</font><p>'
		+"This is the generated xml script.  Values you entered are highlighted in red."
		+"<HR>");
//document.write( "This is the generated xml script.  Values you entered are highlighted in red.<HR>");

//document.write('< ? xml version="1.0"  ? > \r\n'); 
///document.write("Content-Type: text/xml ")



for (i=0;i<hps.length;i++) {
	var vps = new String(hps[i]);
 	document.write("<br>"+vps);
	}



for (i=0;i<aps.length;i++) {
	///alert("aps["+i+"]="+aps[i]);
	var vps = new String(aps[i]);
	document.write("<br>"+vps);
	}



for (i=0;i<cps.length;i++) {
	var vps = new String(cps[i]);
	document.write("<br>"+vps);
	}




}//end function




</script>
	
<script>
function fdg() {
//return;

var BEGINFORM = 0;
var ENDFORM   = document.forms.length;

document.write("<div id='formdebug' align='left'><font face='arial' size='1' color='a00000'>");
for ( jj=BEGINFORM; jj<ENDFORM; jj++ ) {
document.write('<hr> document.forms['+jj+'].name='+document.forms[jj].name+'<br>');
document.write(' document.forms['+jj+'].method='+document.forms[jj].method+'<br>');
document.write(' document.forms['+jj+'].action='+document.forms[jj].action+'<br>');

for(i=0;i<document.forms[jj].length;i++)
{
document.write( 'document.forms['+jj+']::'+ document.forms[jj].name+".elements["+i+"]::"
			  +' ------name: '+document.forms[jj].elements[i].name
			  +' ------type: '+document.forms[jj].elements[i].type
			  +' -----value: '+document.forms[jj].elements[i].value
			  )
			  if ( typeof(document.forms[jj].elements[i].tabindex) != 'undefined') {
			  document.write( ' -----tabindex: '+ document.forms[jj].elements[i].tabindex )
			  }
			  if ( typeof(document.forms[jj].elements[i].onblur) != 'undefined') {
			  document.write( ' -----onblur: '+ document.forms[jj].elements[i].onblur )
			  }
			  if ( document.forms[jj].elements[i].type == 'button' ) {
			  document.write( ' -----onclick: '+ document.forms[jj].elements[i].onclick )
			  }
			  if ( document.forms[jj].elements[i].type == 'radio' ) {
			  document.write( ' -----checked: '+ document.forms[jj].elements[i].checked )
			  }
document.write('<br>')
			  
			  }}




document.write("<HR>");
document.write(	" location.href = "+location.href+"<BR>");
document.write('document.location.href='+document.location.href+'<BR>');
document.write(	" parent.location.href = "+parent.location.href+"<BR>");
document.write("<HR>");



for ( i=0; i<parent.frames.length; i++ ) 
{
document.write(	" parent.frames["+i+"] :: "
			+ " ------name: "+parent.frames[i].name
			+ " ------location.href: "+ parent.frames[i].location.href
			+ "<br>"
			);
			}

document.write("<HR>");
document.write("</font></div>");

}///end function formvardebug()

fdg();

</script>

</body>
</html>

