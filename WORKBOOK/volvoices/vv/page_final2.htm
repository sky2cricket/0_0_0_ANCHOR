
<html>
<head>
<title>
page_01
</title>
<link href="vv_workbook.css" type="text/css" rel="stylesheet">

<script language=javascript src="vv_functions.js"></script>
<script language=javascript src="vv_functions_radio.js"></script>
<script language=javascript src="vv_validation.js"></script>




</head>

<script>document.write('<body onload="load_DF_form();"  bgcolor="'+parent.adb_background_color+'" >');</script>

<font face="arial" size="3">
<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script>
 Workbook Final Page </h2>
</center>

<script>
///Civil War Salt Peter Mining None, LCNAF, ULAN. 





</script>

<form name="DF"  action="saveXML.php" method="POST">

<table class="bgINNER"  border="0" cellpadding="2" cellspacing="1" width="98%" xbgcolor="ddeeff">
<tr class="bgstandard"><td colspan="3">

This is where we will submit the final form that is filled out in
upper.htm


</td></tr>
<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>



<tr class="bgstandard">
<td><font face="arial" size="2" color="000000" ><b></u>
&nbsp;
</td>
<td>&nbsp;
&nbsp;</td>
<td>&nbsp</td>
</tr>

<tr class="bgstandard">
<td colspan="3">
<input type="button" name="B2" 
value="View MODS TAGS without validation" class="buttonnw"
onclick="buildModsTags(2)">
&nbsp;&nbsp;
<!--- input type="button" name="B2" 
value="View MODS TAGS" class="buttonnw"
onclick="buildModsTags(1)" --->
&nbsp;&nbsp;
<input type="button" name="B2" 
value="Create XML File - old way needs view source to see tags" class="buttonnw"
onclick="generate_xml_file()"
>

<p>
<input type="button" name="Bx1" 
value="Create XML File without validation" class="buttonnw"
onclick="doSaveXML(2)"
>
<input type="button" name="Bx2" 
value="Create XML File with validation" class="buttonnw"
onclick="doSaveXML(0)"
>
&nbsp</td>
</tr>





<tr class="bgstandard">
<td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>
</tr>

<tr class="greenrow"><td colspan="3" >&nbsp;</td></tr>






<tr class="bgstandard"><td colspan="3" align="center">
&nbsp;&nbsp;

</td></tr>

</table>


<!--- hidden values to be passed to saveXML.php ----------->
<input type="hidden" name="sHeader" value=""> 
<input type="hidden" name="sCloser" value=""> 
<input type="hidden" name="sPage_01" value=""> 
<input type="hidden" name="sPage_02" value=""> 
<input type="hidden" name="sPage_03" value=""> 
<input type="hidden" name="sPage_04" value=""> 
<input type="hidden" name="sPage_05" value=""> 
<input type="hidden" name="sPage_06" value=""> 






</form name="forms[0]">

<center><font face="arial">
<h2> <script> document.write(parent.adb_project_name); </script>
 Workbook Final Page </h2>
</center>


<hr>


<script>


function doSaveXML(N){

//alert ("doSaveXML("+N+")" );


//document.forms[0].action ="myphp/test_12_p.php";
///alert ("doSaveXML: document.forms[0].action="+document.forms[0].action );
///num = 0 raw
///num = 1 html
var num = 0;
//----------------------------------------------------

var hps= new Array();
var aps_01= new Array();
var aps_02= new Array();
var aps_03= new Array();
var aps_04= new Array();
var aps_05= new Array();
var aps_06= new Array();
var cps= new Array();

var HPS= new String("");
var APS_01= new String("");
var APS_02= new String("");
var APS_03= new String("");
var APS_04= new String("");
var APS_05= new String("");
var APS_06= new String("");
var CPS= new String("");

    
    hps = parent.U.buildTagsArray_header(0);
    aps_01 = parent.U.buildTagsArray_page_01(0);
    aps_02 = parent.U.buildTagsArray_page_02(0);
    aps_03 = parent.U.buildTagsArray_page_03(num);
    aps_04 = parent.U.buildTagsArray_page_04(num);
    aps_05 = parent.U.buildTagsArray_page_05(num);
    aps_06 = parent.U.buildTagsArray_page_06(num);
    cps = parent.U.buildTagsArray_closer(num);

var str= new String();

for ( i=0; i< hps.length; i++ ) { HPS += hps[i]; }
for ( i=0; i< aps_01.length; i++ ) { str=aps_01[i];str=str.replace(/\r\n/g,''); APS_01 += str; }
for ( i=0; i< aps_02.length; i++ ) { APS_02 += aps_02[i]; }
for ( i=0; i< aps_03.length; i++ ) { APS_03 += aps_03[i]; }
for ( i=0; i< aps_04.length; i++ ) { APS_04 += aps_04[i]; }
for ( i=0; i< aps_05.length; i++ ) { APS_05 += aps_05[i]; }
for ( i=0; i< aps_06.length; i++ ) { APS_06 += aps_06[i]; }
for ( i=0; i< cps.length; i++ ) { CPS += cps[i]; }

document.forms[0].sHeader.value= HPS;
document.forms[0].sPage_01.value= APS_01;
document.forms[0].sPage_02.value= APS_02;
document.forms[0].sPage_03.value= APS_03;
document.forms[0].sPage_04.value= APS_04;
document.forms[0].sPage_05.value= APS_05;
document.forms[0].sPage_06.value= APS_06;
document.forms[0].sCloser.value= CPS;

/*
if (!confirm("HPS:\n"+HPS) ) return;
if (!confirm("APS_01:\n"+APS_01) ) return;
if (!confirm("APS_02:\n"+APS_02) ) return;
if (!confirm("APS_03:\n"+APS_03) ) return;
//if (!confirm("APS_04:\n"+APS_04) ) return;
if (!confirm("APS_05:\n"+APS_05) ) return;
if (!confirm("APS_06:\n"+APS_06) ) return;
if (!confirm("CPS:\n"+CPS) ) return;
*/

document.forms[0].submit();

}//end function





function buildModsTags(N) {

var num = new Number();
    num = N;

///num=2 for incomplete tags
if (num < 2 ) {
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
//before writing anything, make sure all required fields are populated

if ( parent.U.document.UF.validate_page_begin.value == "0" ) {
	alert("You have not completed required fields on the begin page.");
	return false;
	}
if ( parent.U.document.UF.validate_page_01.value == "0" ) {
	alert("You have not completed required fields on page 1.");
	return false;
	}

if ( parent.U.document.UF.validate_page_02.value == "0" ) {
	alert("You have not completed required fields on page 2.");
	return false;
	}

if ( parent.U.document.UF.validate_page_03.value == "0" ) {
	alert("You have not completed required fields on page 3.");
	return false;
	}

if ( parent.U.document.UF.validate_page_04.value == "0" ) {
	alert("You have not completed required fields on page 4.");
	return false;
	}

if ( parent.U.document.UF.validate_page_05.value == "0" ) {
	alert("You have not completed required fields on page 5.");
	return false;
	}


if ( parent.U.document.UF.validate_page_06.value == "0" ) {
	alert("You have not completed required fields on page 6.");
	return false;
	}


//var tch=true;
//tch = checkAllRequiredElements();
//if (!tch) return;
//if (!confirm("tch="+tch))return;
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

}
if (num==2) num=1;

//load_UF_form();

var aps_01= new Array();
var aps_02= new Array();
var aps_03= new Array();
var aps_04= new Array();
var aps_05= new Array();
var aps_06= new Array();

var hps= new Array();
var cps= new Array();
    
    hps = parent.U.buildTagsArray_header(num);
    aps_01 = parent.U.buildTagsArray_page_01(num);
    aps_02 = parent.U.buildTagsArray_page_02(num);
    aps_03 = parent.U.buildTagsArray_page_03(num);
    aps_04 = parent.U.buildTagsArray_page_04(num);
    aps_05 = parent.U.buildTagsArray_page_05(num);
    aps_06 = parent.U.buildTagsArray_page_06(num);
    cps = parent.U.buildTagsArray_closer(num);

//=================================================

if (num == "0") {

document.write('header("Content-type: application/octet-stream");');
///document.write('header("Content-Disposition: attachment; filename=\"new.xml\"");');
document.write('\n\n');	

}else{


document.write('<input type="button" name="BBACK" onclick="javascript: history.back()" value="BACK"><BR>');
document.write('<font face="Elephant" size="3" color="a00000">PRELIMINARY COPY FOR DEMONSTRATION PURPOSES ONLY</font><p>'
		+"This is the generated xml script.  Values you entered are highlighted in red."
		+"There are spaces after left angle brackets ( < ) to allow this to be displayed. <HR>");

///document.write('< ? xml version="1.0"  ? > \r\n'); 
///document.write("Content-Type: text/xml ")

}


var  abreak = new String("");

if (num != "0") {
    abreak = "<BR>";
	}

for (i=0;i<hps.length;i++) {
	var vps = new String(hps[i]);
 	document.write(abreak+vps);
	}





for (i=0;i<aps_01.length;i++) {
	var vps = new String(aps_01[i]);
	document.write(abreak+vps);
	}

for (i=0;i<aps_02.length;i++) {
	var vps = new String(aps_02[i]);
	document.write("<br>"+vps);
	}

for (i=0;i<aps_03.length;i++) {
	var vps = new String(aps_03[i]);
	document.write(abreak+vps);
	}

for (i=0;i<aps_04.length;i++) {
	var vps = new String(aps_04[i]);
	document.write(abreak+vps);
	}

for (i=0;i<aps_05.length;i++) {
	var vps = new String(aps_05[i]);
	document.write("<br>"+vps);
	}


for (i=0;i<aps_06.length;i++) {
	var vps = new String(aps_06[i]);
	document.write(abreak+vps);
	}





for (i=0;i<cps.length;i++) {
	var vps = new String(cps[i]);
	document.write(abreak+vps);
	}


//document.forms[0].target="new.xml";
//document.forms[0].submit();

}//end function




function generate_xml_file () {


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
//before writing anything, make sure all required fields are populated

if ( parent.U.document.UF.validate_page_begin.value == "0" ) {
	alert("You have not completed required fields on the begin page.");
	return false;
	}
if ( parent.U.document.UF.validate_page_01.value == "0" ) {
	alert("You have not completed required fields on page 1.");
	return false;
	}

if ( parent.U.document.UF.validate_page_02.value == "0" ) {
	alert("You have not completed required fields on page 2.");
	return false;
	}

if ( parent.U.document.UF.validate_page_03.value == "0" ) {
	alert("You have not completed required fields on page 3.");
	return false;
	}

if ( parent.U.document.UF.validate_page_04.value == "0" ) {
	alert("You have not completed required fields on page 4.");
	return false;
	}

if ( parent.U.document.UF.validate_page_05.value == "0" ) {
	alert("You have not completed required fields on page 5.");
	return false;
	}


if ( parent.U.document.UF.validate_page_06.value == "0" ) {
	alert("You have not completed required fields on page 6.");
	return false;
	}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////


var aps_01= new Array();
var aps_02= new Array();
var aps_03= new Array();
var aps_04= new Array();
var aps_05= new Array();
var aps_06= new Array();

var hps= new Array();
var cps= new Array();
    
    hps = parent.U.buildTagsArray_header(0);
    aps_01 = parent.U.buildTagsArray_page_01(0);
    aps_02 = parent.U.buildTagsArray_page_02(0);
    aps_03 = parent.U.buildTagsArray_page_03(0);
    aps_04 = parent.U.buildTagsArray_page_04(0);
    aps_05 = parent.U.buildTagsArray_page_05(0);
    aps_06 = parent.U.buildTagsArray_page_06(0);
    cps = parent.U.buildTagsArray_closer(0);

document.write('header("Content-type: application/octet-stream");');
///document.write('header("Content-Disposition: attachment; filename=\"new.xml\"");');
document.write('\n\n');	


var vv = new String("")

for (i=0;i<hps.length;i++) {
	var vps = new String(hps[i]);
 	document.write(vps+vv);
	}


for (i=0;i<aps_01.length;i++) {
	var vps = new String(aps_01[i]);
	document.write(vps+vv);
	}

for (i=0;i<aps_02.length;i++) {
	var vps = new String(aps_02[i]);
	document.write(vps+vv);
	}

for (i=0;i<aps_03.length;i++) {
	var vps = new String(aps_03[i]);
	document.write(vps+vv);

	}

for (i=0;i<aps_04.length;i++) {
	var vps = new String(aps_04[i]);
	document.write(vps+vv);
	}

for (i=0;i<aps_05.length;i++) {
	var vps = new String(aps_05[i]);
	document.write(vps+vv);

	}


for (i=0;i<aps_06.length;i++) {
	var vps = new String(aps_06[i]);
	document.write(vps+vv);
	}



for (i=0;i<cps.length;i++) {
	var vps = new String(cps[i]);
	document.write(vps+vv);
	}



///parent.U.document.UF.method = "POST"
///parent.U.document.UF.target = "new.xml";
///parent.U.document.UF.submit();


}//end function generate_xml_file()


///
///formvardebug();//funnction in vv_validation.js






</script>
	


</body>
</html>

